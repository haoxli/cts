{"version":3,"file":"atomicSub.spec.js","names":["description","makeTestGroup","GPUTest","dispatchSizes","workgroupSizes","runTest","g","test","specURL","desc","params","u","combine","fn","t","numInvocations","workgroupSize","dispatchSize","bufferNumElements","initValue","op","expected","Uint32Array"],"sources":["../../../../../../../../src/webgpu/shader/execution/expression/call/builtin/atomics/atomicSub.spec.ts"],"sourcesContent":["export const description = `\nAtomically read, subtract and store value.\n\n* Load the original value pointed to by atomic_ptr.\n* Obtains a new value by subtracting with the value v.\n* Store the new value using atomic_ptr.\n\nReturns the original value stored in the atomic object.\n`;\n\nimport { makeTestGroup } from '../../../../../../../common/framework/test_group.js';\nimport { GPUTest } from '../../../../../../gpu_test.js';\n\nimport { dispatchSizes, workgroupSizes, runTest } from './harness.js';\n\nexport const g = makeTestGroup(GPUTest);\n\ng.test('sub')\n  .specURL('https://www.w3.org/TR/WGSL/#atomic-rmw')\n  .desc(\n    `\nAS is storage or workgroup\nT is i32 or u32\n\nfn atomicSub(atomic_ptr: ptr<AS, atomic<T>, read_write>, v: T) -> T\n`\n  )\n  .params(u => u.combine('workgroupSize', workgroupSizes).combine('dispatchSize', dispatchSizes))\n  .fn(t => {\n    const numInvocations = t.params.workgroupSize * t.params.dispatchSize;\n    const bufferNumElements = 2;\n\n    const initValue = 0;\n    const op = `atomicSub(&output[0], 1)`;\n    const expected = new Uint32Array(bufferNumElements);\n    expected[0] = -1 * numInvocations;\n\n    runTest({\n      t,\n      workgroupSize: t.params.workgroupSize,\n      dispatchSize: t.params.dispatchSize,\n      bufferNumElements,\n      initValue,\n      op,\n      expected,\n    });\n  });\n"],"mappings":";AAAA;AAAA,GAAA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,SAASC,aAAa,QAAQ,qDAAqD;AACnF,SAASC,OAAO,QAAQ,+BAA+B;;AAEvD,SAASC,aAAa,EAAEC,cAAc,EAAEC,OAAO,QAAQ,cAAc;;AAErE,OAAO,MAAMC,CAAC,GAAGL,aAAa,CAACC,OAAO,CAAC;;AAEvCI,CAAC,CAACC,IAAI,CAAC,KAAK,CAAC;AACVC,OAAO,CAAC,wCAAwC,CAAC;AACjDC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA,CAAC,CACE;;AACAC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,eAAe,EAAER,cAAc,CAAC,CAACQ,OAAO,CAAC,cAAc,EAAET,aAAa,CAAC,CAAC;AAC9FU,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,cAAc,GAAGD,CAAC,CAACJ,MAAM,CAACM,aAAa,GAAGF,CAAC,CAACJ,MAAM,CAACO,YAAY;EACrE,MAAMC,iBAAiB,GAAG,CAAC;;EAE3B,MAAMC,SAAS,GAAG,CAAC;EACnB,MAAMC,EAAE,GAAI,0BAAyB;EACrC,MAAMC,QAAQ,GAAG,IAAIC,WAAW,CAACJ,iBAAiB,CAAC;EACnDG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAGN,cAAc;;EAEjCV,OAAO,CAAC;IACNS,CAAC;IACDE,aAAa,EAAEF,CAAC,CAACJ,MAAM,CAACM,aAAa;IACrCC,YAAY,EAAEH,CAAC,CAACJ,MAAM,CAACO,YAAY;IACnCC,iBAAiB;IACjBC,SAAS;IACTC,EAAE;IACFC;EACF,CAAC,CAAC;AACJ,CAAC,CAAC"}